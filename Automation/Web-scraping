from arcgis.gis import GIS
import requests
import pandas as pd

# Connect to the GIS platform (replace 'gis_url', 'username', and 'password' with actual credentials)
gis = GIS("home")

# URL of the CSV file
url = "http://data-prod-cocorahs-org.azurewebsites.net/export/exportreports.aspx?ReportType=Daily&dtf=3&Format=CSV&State=TX&County=BLC&ReportDateType=reportdate&StartDate=10/1/2012&EndDate=7/27/2023&TimesInGMT=False"

# Fetch the CSV file using requests
response = requests.get(url)

# Check if the request was successful
if response.status_code == 200:
    # Save the CSV file locally
    with open("/arcgis/home/blancoTX_cocorahs_data.csv", "wb") as f:
        f.write(response.content)
    print("CSV file downloaded successfully.")
else:
    print(f"Failed to download the CSV file. Status code: {response.status_code}")
